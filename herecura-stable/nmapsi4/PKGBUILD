# Maintainer: Jeff Meldrum <jeffmeld(AT)lightspeed(DOT)ca>

pkgname=nmapsi4
pkgver=0.1.1
pkgrel=3
pkgdesc="Qt-based Gui nmap interface."
arch=('i686' 'x86_64')
url="http://nmapsi.sourceforge.net/"
license=('GPL2')
conflicts=()
depends=('qt' 'nmap')
makedepends=('cmake>=2.6')
source=(http://nmapsi4.googlecode.com/files/${pkgname}-${pkgver}.tar.gz)
md5sums=('11a81b6193829963ff7b11fbddf61bad')

build() {

# Remove previous build if it exists
    rm -rf src

  cd ${srcdir}/${pkgname}-${pkgver}
# Fix gcc 4.5 compiling bug
  sed -i -e 's/::QSize//g' src/core/nmapParser.cpp 
  sed -i -e 's/::QSize//g' src/preference/profilemain.cpp

# Run cmake script
  cd tools
    ./cmake_verbose_script.sh

  cd ../build  
# Change package location to /usr from /usr/local	
  sed -i 's_/usr/local_/usr_' ./cmake_install.cmake 

  make || return 1
	make DESTDIR=${pkgdir} install
# Change permissions to enable the excutables
  chmod 755 ${pkgdir}/usr/bin/*
}

# vim:set ts=2 sw=2 et:
