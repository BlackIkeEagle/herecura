# Maintainer: BlackEagle < ike DOT devolder AT gmail DOT com >
pkgname=par2cmdline
pkgver=0.4
pkgrel=15
pkgdesc="Providing a tool to apply the data-recovery capability concepts of RAID-like systems to the posting & recovery of multi-part archives on Usenet."
url="http://sourceforge.net/projects/parchive/"
license="GPL"
depends=('gcc-libs')
makedepends=()
arch=('i686' 'x86_64')
source=(
	"http://downloads.sourceforge.net/sourceforge/parchive/${pkgname}-${pkgver}.tar.gz"
	'par2cmdline-0.4-autoconf.patch'
	'par2cmdline-0.4-wildcard-fix.patch'
	'par2cmdline-0.4-offset.patch'
	'par2cmdline-0.4-letype.patch'
	'par2cmdline-0.4-gcc4.patch'
	'par2cmdline-0.4-cosmetic.patch'
	'par2cmdline-0.4-hardlinks.patch'
)
sha256sums=(
	'9e32b7dbcf7bca8249f98824757d4868714156fe2276516504cd26f736e9f677'
	'47a8342fca3248a9b49415c735b68b58fa98b77d553fe13e27162649b5114a5b'
	'56d0fe724853298b818a8067b39d918ab2c8e27bb81380fde0499cecea41ab4b'
	'391ffaea8c7a684dbc40ed1edc221681d34a58feafd707d36b0a0af3436d3917'
	'54b41cc8237dd0764629267ca51ded256f820c6bc100acfa3d011638b07b5973'
	'eda0a381f944b1bc9d3d78bf4526f77620bcb01de48abcb08878178e47c833f7'
	'63390cbee6275f427756e3c457d082e5a67b9bf209dfe8d4381945fd7c118a47'
	'89643a2373fa097fccfd7d30d7b42c6225c71b7acd90cd6c863db9688c4af6be'
)

build() {
	cd ${pkgname}-${pkgver}
	msg "patch autoconf failure"
	patch -N -i ../par2cmdline-0.4-autoconf.patch
	msg "patch wildcard-fix"
	patch -N -i ../par2cmdline-0.4-wildcard-fix.patch
	msg "patch offset"
	patch -N -i ../par2cmdline-0.4-offset.patch
	msg "patch letype"
	patch -N -i ../par2cmdline-0.4-letype.patch
	msg "patch gcc4"
	patch -N -i ../par2cmdline-0.4-gcc4.patch
	msg "patch cosmetic"
	patch -N -i ../par2cmdline-0.4-cosmetic.patch
	msg "patch hardlinks"
	patch -N -i ../par2cmdline-0.4-hardlinks.patch
	msg "Configure"
	./configure --prefix=/usr
	make
}

package() {
	cd ${pkgname}-${pkgver}
	make DESTDIR=$startdir/pkg install
}
