# Maintainer: BlackEagle < ike DOT devolder AT gmail DOT com >
pkgname=par2cmdline
pkgver=0.4
pkgrel=16
pkgdesc="Providing a tool to apply the data-recovery capability concepts of RAID-like systems to the posting & recovery of multi-part archives on Usenet."
url="http://sourceforge.net/projects/parchive/"
license="GPL"
depends=('gcc-libs')
makedepends=()
arch=('i686' 'x86_64')
source=(
	"http://downloads.sourceforge.net/sourceforge/parchive/${pkgname}-${pkgver}.tar.gz"
	'01-Use-_stati64-under-WIN32-to-get-file-size.patch'
	'02-Report-empty-files-when-verifying.patch'
	'03-Correct-error-in-Par2CreatorSourceFile-UpdateHashes-.patch'
	'04-Updated-changelog.patch'
	'05-offset-must-always-be-updated-even-when-progress-is-.patch'
	'06-Updated-changelog.patch'
	'07-When-a-file-is-specified-to-be-scanned-but-it-dooen-.patch'
	'08-The-create-process-now-splits-the-job-in-as-many-thr.patch'
	'09-Introduced-conditional-compilation-to-speed-up-thing.patch'
	'10-Verifying-and-repairing-now-are-done-in-as-many-thre.patch'
	'11-Multiple-thread-support.patch'
	'12-Optimization-by-inlining.patch'
	'13-Allow-subdirectories-to-be-passed.patch'
	'14-Allowing-commandline-passing-of-files.patch'
	'15-Fixing-processing-of-the-first-file-parameter-the-ou.patch'
	'16-Pack-and-simplify-MD5Hash.patch'
	'17-Use-autogenerated-methods-in-letype.patch'
	'18-Fix-headers-in-par2cmdline.h.patch'
	'19-hardlinks.patch'
	'20-Fix-CPU-detection-to-work-on-platforms-other-than-Ma.patch'
	'21-Remove-autotools-generated-files-add-bootstrap-scrip.patch'
	'22-Link-with-pthreads.patch'
	'23-fixes-an-FTBFS-on-GNU-kFreeBSD.patch'
	'24-fixes-stupid-warnings.patch'
)
sha256sums=(
	'9e32b7dbcf7bca8249f98824757d4868714156fe2276516504cd26f736e9f677'
	'ece2cacec41d820d697e8fb5838b39e5ea1be1ced2a4cbe93d739a05a94db33a'
	'd4976200ea20b44d0efbc8225ed510157a59b921b710a9cf353052df8f7d2175'
	'1024c6dbfc7b8993a683c28a91d156552190ae33c925b217864ea874c8135eeb'
	'eafc7f92a65fa63c7b4c50c641cb7a8b061aed3b89aa393066ec67b0bd98a09b'
	'f6e6c1bb8fbc6eb40947dbc9f14fcf4856de840fa970d3482900408d9aaa2f43'
	'825a769565ead2957d56a05ef4c8d321a0d8d7407c02b2387894458710ec02fd'
	'00efeff75f8a8cf61d47763b9a86ba92c68a7201d1ec50915830802b08f466e2'
	'1675737692fc606225515eb97315290dae4fba84b9eabed2a711834f88b5b090'
	'a472bc0321cde509d0bfe1d0887a3209ba4997673d7e5a49c31cf225546da802'
	'ce8a69abe01e5e8a01904305d9ae74980f700f6becedd789241f7b26348dc6fe'
	'4f17476f51151d0ee1dfa4ca42f2860f36d17430377d7bb22d19d32a213b3abc'
	'ff9aba8c2b5e5050f811e11331637241db2fed48c2bbf5a34c970b70d45b6179'
	'76d8f406edd8201209849626afd8c383b0908fb7fdd68747231af77558754568'
	'3076b42f152c447a24f119b5586ef702a994efa6f4fbb3a3a51d1122effef435'
	'4e5c70345b1bd40019c58c0f334a76d9ece5bbb3cd08e1fb1a16b614c8e2e0cb'
	'4f562411d3d431af99560789cfd69f4d6c72ca82986d4999f8ab7e6c0db7f912'
	'3b7c0644143b6498ca21cb6b892b645346092f79aa5d0bc0e56fbd6181eb2e31'
	'13ce51e827cd6c959a6cd92322e79df26e59f4177d831530239be491b8ffc9ff'
	'a1f6f551acf5d05f2173d6ac328a30044f2af2f2f15e87547e69fad5250a2653'
	'5897875bc5ca7e5efc7f4ee53c7a07ffb26034c90d3aaff2b3a3bd25ac08190d'
	'83b07c993e3e6d3a23fd6aabf9c864bd3b5ecf2bc0bc64ef483a5e852799368e'
	'9c418d960263aa0a43d9ca93ea21c002281faa39aae82c2a4bf21e7820cb3a06'
	'9c58d269d4c86e227653b39981557e8d3cadca5178bdafa9d04c435c9324568e'
	'0c2413f0d1c024127063b5cbb0a403fe12555ec820190f7981db4a5a82be7b62'
)

build() {
	cd ${pkgname}-${pkgver}
	for patch in ${startdir}/[0-9][0-9]*.patch; do
		msg ${patch}
		patch -Np1 -i ${patch}
	done
	msg "Bootstrap"
	chmod +x bootstrap
	./bootstrap
	msg "Configure"
	./configure --prefix=/usr
	msg "Make"
	make
}

package() {
	cd ${pkgname}-${pkgver}
	make DESTDIR=$startdir/pkg install
}
