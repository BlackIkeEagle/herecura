# vim:set ft=sh:
# Contributor: BlackEagle < ike DOT devolder AT gmail DOT com >

pkgname=krusader-git
_gitname='krusader'
pkgver=20130424.b1c8dc0
pkgrel=1
pkgdesc="Krusader - Twin Panel File Management For Your Desktop - GIT version"
arch=('i686' 'x86_64')
url="http://www.krusader.org/"
license=('GPL')
depends=('kdelibs')
makedepends=('git' 'cmake' 'automoc4')
provides=('krusader')
conflicts=('krusader')
replaces=('krusader' 'krusader-svn')
source=("$_gitname::git://anongit.kde.org/krusader")
md5sums=('SKIP')

pkgver() {
	cd "$srcdir/$_gitname"
	echo $(git log -1 --format="%ci" | sed 's/.*\([0-9]\{4\}\)-\([0-9]\{2\}\)-\([0-9]\{2\}\).*/\1\2\3/').$(git rev-parse --short HEAD)
}

build() {
	msg "creating build directory"
	cd ${srcdir}
	[ -d ${_gitname}-build ] && rm -rf ${_gitname}-build
	/usr/share/git/workdir/git-new-workdir ${_gitname} ${_gitname}-build master

	msg "Starting make..."
	cd ${_gitname}-build
	cmake -DCMAKE_INSTALL_PREFIX=/usr .
	make
}

package() {
	cd ${_gitname}-build
	make DESTDIR=${pkgdir} install
}
